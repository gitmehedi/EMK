<openerp>
	<data>
		<record id="inherited_view_inventory_form_extend" model="ir.ui.view">
			<field name="name">stock.inventory.extend.inharit</field>
			<field name="model">stock.inventory</field>
			<field name="mode">primary</field>
			<field name="priority" eval="20" />
			<field name="inherit_id" ref="stock.view_inventory_form" />
			<field name="arch" type="xml">
				<data>
					<xpath expr="//button[@name='prepare_inventory']" position="replace">
						<button name="prepare_inventory_matrix" states="draft"
							string="Start Inventory" type="object" class="oe_highlight" />
					</xpath>

					<xpath expr="//field[@name='product_id']" position="after">
						<field name="product_tmp_id" attrs="{'required': True}" />
					</xpath>

					<xpath expr="//field[@name='filter']" position="replace">
						<field name="filter" string="Inventory of" widget='radio'
							attrs="{'readonly': [('state', '!=', 'draft')],'invisible':True}"
							on_change="onchange_filter(filter)" />
					</xpath>

					<xpath expr="//field[@name='product_id']" position="replace">
						<field name="product_id" domain="[('type','=','product')]"
							attrs="{'invisible': True, 'required': False}" />
					</xpath>

					<xpath expr="//field[@name='line_ids']" position="replace">
						<field name="line_ids" widget="x2many_2d_opening_matrix"
							field_x_axis="size_value_id" field_y_axis="color_value_id"
							field_value="product_qty" field_theoretical_value='theoretical_qty' />
					</xpath>
				</data>
			</field>
		</record>


		<record model="ir.actions.act_window" id="stock_inventory_matrix_action">
			<field name="name">Inventory Adjustment</field>
			<field name="res_model">stock.inventory</field>
			<field name="view_type">form</field>
			<field name="context">{'default_filter': 'product'}</field>
			<field name="view_mode">tree,form</field>
		</record>


		<record id="action_matrix_form_view_extend" model="ir.actions.act_window.view">
			<field eval="2" name="sequence" />
			<field name="view_mode">form</field>
			<field name="view_id" ref="inherited_view_inventory_form_extend" />
			<field name="act_window_id" ref="stock_inventory_matrix_action" />
		</record>

		<record id="action_matrix_tree_view_extend" model="ir.actions.act_window.view">
			<field eval="1" name="sequence" />
			<field name="view_mode">tree</field>
			<field name="view_id" ref="stock.view_inventory_tree" />
			<field name="act_window_id" ref="stock_inventory_matrix_action" />
		</record>


		<menuitem name="Inventory Adjustment Matrix" id="menu_stock_inventory_maxtix"
			parent="stock.menu_stock_inventory_control" action="stock_inventory_matrix_action" />
			
		<menuitem action="stock.action_inventory_form" id="stock.menu_action_inventory_form"
			parent="stock.menu_stock_inventory_control" sequence="30" groups='base.group_erp_manager' />
	</data>
</openerp>