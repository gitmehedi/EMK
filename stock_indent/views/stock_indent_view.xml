<?xml version="1.0" encoding="utf-8"?>
<odoo>
	<data>
		<record id='view_indent_indent_tree' model='ir.ui.view'>
			<field name="name">indent.indent.tree</field>
			<field name="model">indent.indent</field>
			<field name="arch" type="xml">
				<tree string="Indents" decoration-bf="message_needaction == True"
					  colors="gray:state=='received';green:state=='waiting_approval';blue:state=='inprogress';red:state=='reject';">
					<field name="name" />
					<field name="indentor_id" />
					<field name="department_id" />
					<field name="indent_date" />
					<field name="required_date" />
					<field name="approve_date" />
					<field name="state" />
					<field name="message_needaction" invisible="1"/>
				</tree>
			</field>
		</record>
		<!-- Indent Form View -->
		<record id='view_stock_indent_indent_form' model='ir.ui.view'>
			<field name="name">indent.indent.form</field>
			<field name="model">indent.indent</field>
			<field name="arch" type="xml">
				<form string="Indents">
					<header>
						<button name="indent_confirm" string="Confirm" states="draft"
								class="oe_highlight" type="object"/>
						<button name="approve_indent" string="Approve" states="waiting_approval" type="object"
								class="oe_highlight" groups="inventory_user.grp_inv_supervisor" />
								<!--groups="inventory_user.grp_inv_supervisor"-->
						<button name="reject_indent" string="Reject" states="waiting_approval"
								groups="inventory_user.grp_inv_supervisor" type="object"/>
						<button name="action_view_picking" string="Issue Product(s)" type="object" invisible="1"
								states="inprogress" class="oe_highlight" groups="inventory_user.grp_inv_department_executive" />
						<!--groups="inventory_user.grp_inv_department_executive"-->
						<button name="action_close_indent" string="Close" type="object"
								states="inprogress" groups="stock.group_stock_user"/>
						<button name="action_issue_product" string="Issue Products" type="object" class="oe_highlight"
								states="inprogress"/>

						<field name="state" widget="statusbar"
							   statusbar_visible="draft,waiting_approval,inprogress,received"
							   statusbar_colors='{"reject":"red"}' />
					</header>
					<sheet>
						<group>
							<group>
								<field name="indentor_id" readonly="1" />
								<field name="requirement"/>
								<field name="department_id"/>

							</group>
							<group>
								<field name="indent_date" />
								<field name="required_date" />
								<field name="approve_date" invisible="1"/>
								<field name="indent_type" options="{'no_create': True,'no_open':True}"
									   placeholder="Please Select"/>
							</group>
						</group>

						<notebook>
							<page string="Products">

								<field name="product_lines">
									<tree string="Products" editable="bottom" decoration-success="received_qty==product_uom_qty and state=='inprogress'" decoration-bf="received_qty==product_uom_qty and state=='inprogress'" decoration-danger="received_qty!=product_uom_qty and state=='inprogress'">
										<field name="sequence" widget="handle"/>
										<field name="product_id" domain="[('type','!=','service')]" options="{'no_open': True,'no_create_edit': true}" attrs="{'readonly':[('state','not in',('draft','waiting_approval'))]}" />
										<field name="remarks" attrs="{'readonly':[('state','not in',('draft','waiting_approval'))]}" />
										<field name="state" invisible="1"/>
										<field name="qty_available" readonly="1" groups=""  />
										<field name="product_uom" string="UOM" options="{'no_open': True,'no_create_edit': true}" attrs="{'readonly':[('state','not in',('draft','waiting_approval'))]}" />
										<field name="product_uom_qty" sum="Total Qty"  attrs="{'readonly':[('state','not in',('draft','waiting_approval'))]}"/>
										<field name="received_qty" sum="Total Receive Qty" attrs="{'readonly':[('state','in',('draft','waiting_approval'))]}"/>
										<field name="issue_qty" invisible="1" attrs="{'readonly':[('state','in',('draft','waiting_approval'))]}"/>

									</tree>
								</field>

								<group>
									<field name="material_required_for" placeholder="The material is required for..." />
								</group>
							</page>
							<page string="Others">
								<group>
									<group>
										<field name="company_id" groups="base.group_multi_company"
											   options="{'no_create': True,'no_open':True}"/>
										<field name="move_type" />
										<field name="approver_id" invisible="1"/>
										<field name="closer_id" invisible="1"/>
										<field name="pr_indent_check" invisible="1"/>
									</group>
									<group>
										<!--<field name="manager_id" readonly="1" />-->
										<field name="warehouse_id" groups="stock.group_stock_multi_locations" options="{'no_create': True,'no_open':True}"/>
										<field name="stock_location_id" options="{'no_create': True,'no_open':True}" groups="stock.group_stock_multi_locations"/>
										<field name="picking_type_id"/>
										<!--groups="stock.group_stock_manager"-->
<!--										 -->
									</group>
								</group>
							</page>
						</notebook>
					</sheet>
					<div class="oe_chatter">
						<field name="message_follower_ids" widget="mail_followers" />
						<field name="message_ids" widget="mail_thread" />
					</div>
				</form>
			</field>
		</record>

		<!-- Indent Window Action -->
		<record id='action_indent_indent' model='ir.actions.act_window'>
			<field name="name">Indents</field>
			<field name="res_model">indent.indent</field>
			<field name="view_type">form</field>
			<field name="view_mode">tree,form</field>
			<field name="domain">[('state','=','draft')]</field>
			<field name="help" type="html">
				<p class="oe_view_nocontent_create">
					Click to create a new indent.
				</p>
			</field>
		</record>

		<record id='action_indent_confirm' model='ir.actions.act_window'>
			<field name="name">Indents</field>
			<field name="res_model">indent.indent</field>
			<field name="view_type">form</field>
			<field name="view_mode">tree,form</field>
			<field name="domain">[('state','=','waiting_approval')]</field>
			<field name="help" type="html">
				<p class="oe_view_nocontent_create">
					No Indent for Confirm.
				</p>
			</field>
		</record>
		<record id='action_indent_done' model='ir.actions.act_window'>
			<field name="name">Indents</field>
			<field name="res_model">indent.indent</field>
			<field name="view_type">form</field>
			<field name="view_mode">tree,form</field>
			<field name="domain">[('state','=','received')]</field>
			<field name="help" type="html">
				<p class="oe_view_nocontent_create">
					No Indent for Received.
				</p>
			</field>

		</record>

		<!-- Indent Approval Window Action -->
		<record id='action_indent_waiting_for_approval' model='ir.actions.act_window'>
			<field name="name">Indents</field>
			<field name="res_model">indent.indent</field>
			<field name="view_type">form</field>
			<field name="view_mode">tree,form</field>
			<field name="domain">[('state','=','inprogress')]</field>
			<field name="help" type="html">
				<p class="oe_view_nocontent_create">
					No Indent for approval.
				</p>
			</field>
		</record>
		<!-- Indent Menu -->
		<menuitem name="Indents" parent="stock.menu_stock_root" id="menu_indent_indent_main"
				  sequence="1" groups="base.group_user"/>

		<menuitem action="action_indent_indent" name="Indent (Draft)"
				  parent="stock_indent_menu.menu_stock_indent" id="menu_indent_indent_raise" sequence="5"
				  groups="base.group_user"/>

		<menuitem action="action_indent_confirm" name="Indent (Confirmed)"
				  parent="stock_indent_menu.menu_stock_indent" id="menu_indent_indent" sequence="10"
				  groups="base.group_user"/>

		<menuitem action="action_indent_waiting_for_approval" name="Indent (Approved)"
				  parent="stock_indent_menu.menu_stock_indent" id="menu_indent_waiting_for_approval" sequence="15"
				  groups="inventory_user.grp_inv_supervisor"/>

		<menuitem action="action_indent_done" name="Indent (Done)"
				  parent="stock_indent_menu.menu_stock_indent" id="menu_indent_done" sequence="20"
				  groups="inventory_user.grp_inv_supervisor"/>
	</data>
</odoo>