<?xml version="1.0" encoding="UTF-8"?>
<openerp>
	<data>
		<record id="inherited_purchase_requisition_view_form_inherit_state"
			model="ir.ui.view">
			<field name="name">Purchase Requisition Form</field>
			<field name="model">purchase.requisition</field>
			<field name="inherit_id"
				ref="purchase_requisition.view_purchase_requisition_form" />
			<field name="arch" type="xml">
				<xpath expr="//form/header/button[@name='sent_suppliers']"
					position="after">
					<button name="action_approved" states="in_progress" string="Approved"
						type="object" class="oe_highlight"
						groups="purchase_requisition_approval.group_purchase_requisition_user_approval" />
				</xpath>
				<xpath expr="//form/header/button[@name='open_bid']" position="replace">
					<button name="open_bid" type="object" states="approved"
						string="Close Call for Bids" class="oe_highlight" />
					<button name="action_close" states="approved" string="Close"
						type="object" class="" />
				</xpath>
				<xpath expr="//form/header/field[@name='state']" position="replace">
					<field name="state" widget="statusbar"
						statusbar_visible="draft,in_progress,approved,open,done"
						statusbar_colors="{&quot;in_progress&quot;:&quot;blue&quot;}" />
				</xpath>
				
				<xpath expr="//page[1]/separator" position="replace">
					<separator string="Requests For Quotation" attrs="{'invisible': [('state', 'in', ('draft','in_progress'))]}"/>
				</xpath>
				<xpath expr="//page[1]/button" position="replace">
					<button name="%(purchase_requisition.action_purchase_requisition_partner)d" type="action"
                        string="Request a Quotation" icon="fa-cogs"
                        attrs="{'invisible': ['|', ('line_ids','=',[]),('state', 'in', ('draft','in_progress' ,'open','done'))]}"/>
				</xpath>

					<xpath expr="//page[1]/field[@name='purchase_ids']" position="replace">
						<field name="purchase_ids" options="{'reload_on_button': true}" attrs="{'invisible': [('state', 'in', ('draft','in_progress'))]}">
	                            <tree string="Purchase Order">
	                                <field name="name" string="Reference"/>
	                                <field name="date_order" string="Order Date"/>
	                                <field name="partner_id"/>
	                                <field name="company_id" groups="base.group_multi_company" options="{'no_create': True}"/>
	                                <field name="dest_address_id" groups="stock.group_locations"/>
	                                <field name="date_planned" invisible="1"/>
	                                <field name="origin"/>
	                                <field name="state"/>
	                                <button name="button_cancel" states="draft,sent,to approve,purchase" string="Cancel Purchase Order" type="object" icon="fa-times"/>
	                                <button name="button_confirm" states="draft" string="Confirm Purchase Order" type="object" icon="fa-check"/>
	                                <button name="button_approve" states="to approve" string="Approved by Vendor" type="object" icon="fa-check-square-o"/>
	                                <button name="action_rfq_send" states="draft" string="Send RFQ by Email" type="object" context="{'send_rfq':True}" icon="fa-envelope-o"/>
	                            </tree>
	                        </field>
                        </xpath>

			</field>
		</record>

		<menuitem id="purchase_requisition.menu_purchase_requisition_pro_mgt"
			name="Purchase Requisition" sequence="10"
			parent="purchase.menu_procurement_management" action="purchase_requisition.action_purchase_requisition" />

	</data>
</openerp>
